CREATE VIEW nie_przydzielony AS
SELECT programy_studiow.nazwa_przedmiotu AS przedmiot,
    programy_studiow.typ_zajec AS rok,
    programy_studiow.rok_studiow AS typ,
    grupy.nazwa AS grupa
   FROM programy_studiow
     JOIN grupy ON programy_studiow.rok_studiow = grupy.rok_studiow AND programy_studiow.typ_zajec = grupy.typ_zajec
EXCEPT
 SELECT programy_studiow.nazwa_przedmiotu AS przedmiot,
    programy_studiow.typ_zajec AS rok,
    programy_studiow.rok_studiow AS typ,
    grupy.nazwa AS grupa
   FROM przydzial_zajec
     JOIN programy_studiow ON przydzial_zajec.id_przedmiotu = programy_studiow.id
     JOIN grupy ON grupy.id = przydzial_zajec.grupa;
